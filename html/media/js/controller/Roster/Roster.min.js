function filter(e,t){var n=t.keyCode,r=JSON.parse(window.localStorage.roster),i=Array();r.members.filter(function(t){if(e.name!==undefined&&t.character.name.toLowerCase().search(e["name"].toLowerCase())==-1){console.log("Added "+t.character.name+" because it's name matches");i.push(t.character.name)}if(e["race"]!="all"&&e.race!==undefined&&t.character.race!=e["race"]){console.log("Added "+t.character.name+" because its race matches");i.push(t.character.name)}if(e["class"]!="all"&&e["class"]!==undefined&&t.character.class!=e["class"]){console.log("Added "+t.character.name+" because its class matches");i.push(t.character.name)}if(e.minLevel!==undefined&&e.maxLevel!==undefined)if(t.character.level<parseInt(e.minLevel,10)||t.character.level>parseInt(e.maxLevel,10)){console.log("Added "+t.character.name+" because it's NOT in the level range");i.push(t.character.name)}if(e.rank!==undefined&&e["rank"]!="all"&&t.rank!=e["rank"]){console.log("Added "+t.character.name+" because it's NOT the correct rank");i.push(t.character.name)}});$.each(r.members,function(e,t){$.inArray(t.character.name,i)==-1&&$("tr.character."+t.character.name.toLowerCase()).removeClass("hidden").fadeIn("medium");$.inArray(t.character.name,i)!=-1&&$("tr.character."+t.character.name.toLowerCase()).addClass("hidden").fadeOut("medium")})}(function(e){e.widget("custom.combobox",{_create:function(){this.wrapper=e("<span>").addClass("custom-combobox").insertAfter(this.element);this.element.hide();this._createAutocomplete();this._createShowAllButton()},_createAutocomplete:function(){var t=this.element.children(":selected"),n=t.val()?t.text():"";this.input=e("<input>").appendTo(this.wrapper).val(n).attr("title","").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:e.proxy(this,"_source")}).tooltip({tooltipClass:"ui-state-highlight"});this._on(this.input,{autocompleteselect:function(e,t){t.item.option.selected=!0;this._trigger("select",e,{item:t.item.option})},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var t=this.input,n=!1;e("<a>").attr("tabIndex",-1).attr("title","Show All Items").tooltip().appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").mousedown(function(){n=t.autocomplete("widget").is(":visible")}).click(function(){t.focus();if(n)return;t.autocomplete("search","")})},_source:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(t.term),"i");n(this.element.children("option").map(function(){var n=e(this).text();if(this.value&&(!t.term||r.test(n)))return{label:n,value:n,option:this}}))},_removeIfInvalid:function(t,n){if(n.item)return;var r=this.input.val(),i=r.toLowerCase(),s=!1;this.element.children("option").each(function(){if(e(this).text().toLowerCase()===i){this.selected=s=!0;return!1}});if(s)return;this.input.val("").attr("title",r+" didn't match any item").tooltip("open");this.element.val("");this._delay(function(){this.input.tooltip("close").attr("title","")},2500);this.input.data("ui-autocomplete").term=""},_destroy:function(){this.wrapper.remove();this.element.show()}})})(jQuery);$.ajax({url:"/ajax/roster/all",type:"GET",dataType:"json",ifModified:!0}).done(function(e){window.localStorage.setItem("roster",JSON.stringify(e))});$(function(){$(window).on("resize",function(){if($(window).width()<="640"){$("th.guild-rank").html("Rank");$("th.achievements").html("Achiev's")}else{$("th.guild-rank").html("Guild Rank");$("th.achievements").html("Achievement Points")}});$("input.nojs").remove();$('select[name="characterName"], select[name="minLevel"], select[name="maxLevel"]').combobox();var e=Array(),t="/roster";$('input[name="characterName"]').bind("keyup change",function(t){e.name=$(this).val();filter(e,t)});$('select[name="race"]').change(function(n){e.race=$(this).val();t=t.replace(/\/race=[\w\-]+/,"");if(e["race"]!="all"){var r=JSON.parse(window.localStorage.roster);t=t+"/race="+r.races[e.race].name.replace(" ","-").toLowerCase()}history.pushState(null,null,t);filter(e,n)});$('select[name="class"]').change(function(n){e["class"]=$(this).val();t=t.replace(/\/class=[\w\-]+/,"");if(e["class"]!="all"){var r=JSON.parse(window.localStorage.roster);t=t+"/class="+r.classes[e["class"]].name.replace(" ","-").toLowerCase()}history.pushState(null,null,t);filter(e,n)});$('input[name$="Level"]').bind("keyup change",function(n){input=$(this).attr("name");e[input]=$(this).val();t=t.replace(/\/level=[0-9]+[\-0-9]*/,"");e.minLevel===undefined&&(e.minLevel=$('input[name="minLevel"]').attr("min"));e.maxLevel===undefined&&(e.maxLevel=$('input[name="maxLevel"]').attr("max"));t=t+"/level="+e.minLevel+"-"+e.maxLevel;history.pushState(null,null,t);filter(e,n)});$('select[name="rank"]').change(function(n){e.rank=$(this).val();t=t.replace(/\/rank=[\w\-]+/,"");if(e["rank"]!="all"){var r=JSON.parse(window.localStorage.roster);t=t+"/rank="+r.ranks[e.rank].toString().replace(" ","-").toLowerCase()}history.pushState(null,null,t);filter(e,n)})});