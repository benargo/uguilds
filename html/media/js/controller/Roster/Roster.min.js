function filter(e,t){var n=t.keyCode,r=JSON.parse(window.localStorage.roster),i=Array();r.members.filter(function(t){if(e.name!==undefined&&t.character.name.toLowerCase().search(e["name"].toLowerCase())==-1){console.log("Added "+t.character.name+" because it's name matches");i.push(t.character.name)}if(e["race"]!="all"&&e.race!==undefined&&t.character.race!=e["race"]){console.log("Added "+t.character.name+" because its race matches");i.push(t.character.name)}if(e["class"]!="all"&&e["class"]!==undefined&&t.character.class!=e["class"]){console.log("Added "+t.character.name+" because its class matches");i.push(t.character.name)}if(e.minLevel!==undefined&&e.maxLevel!==undefined)if(t.character.level<parseInt(e.minLevel,10)||t.character.level>parseInt(e.maxLevel,10)){console.log("Added "+t.character.name+" because it's NOT in the level range");i.push(t.character.name)}if(e.rank!==undefined&&e["rank"]!="all"&&t.rank!=e["rank"]){console.log("Added "+t.character.name+" because it's NOT the correct rank");i.push(t.character.name)}});$.each(r.members,function(e,t){$.inArray(t.character.name,i)==-1&&$("tr.character."+t.character.name.toLowerCase()).removeClass("hidden").fadeIn("medium");$.inArray(t.character.name,i)!=-1&&$("tr.character."+t.character.name.toLowerCase()).addClass("hidden").fadeOut("medium")})}$.ajax({url:"/ajax/roster/all",type:"GET",dataType:"json",ifModified:!0}).done(function(e){window.localStorage.setItem("roster",JSON.stringify(e))});$(function(){$(window).on("resize",function(){if($(window).width()<="640"){$("th.guild-rank").html("Rank");$("th.achievements").html("Achiev's")}else{$("th.guild-rank").html("Guild Rank");$("th.achievements").html("Achievement Points")}});$("input.nojs").remove();var e=Array(),t="/roster";$('input[name="characterName"]').bind("keyup change",function(t){e.name=$(this).val();filter(e,t)});$('select[name="race"]').change(function(n){e.race=$(this).val();t=t.replace(/\/race=[\w\-]+/,"");if(e["race"]!="all"){var r=JSON.parse(window.localStorage.roster);t=t+"/race="+r.races[e.race].name.replace(" ","-").toLowerCase()}history.pushState(null,null,t);filter(e,n)});$('select[name="class"]').change(function(n){e["class"]=$(this).val();t=t.replace(/\/class=[\w\-]+/,"");if(e["class"]!="all"){var r=JSON.parse(window.localStorage.roster);t=t+"/class="+r.classes[e["class"]].name.replace(" ","-").toLowerCase()}history.pushState(null,null,t);filter(e,n)});$('input[name$="Level"]').bind("keyup change",function(n){input=$(this).attr("name");e[input]=$(this).val();t=t.replace(/\/level=[0-9]+[\-0-9]*/,"");e.minLevel===undefined&&(e.minLevel=$('input[name="minLevel"]').attr("min"));e.maxLevel===undefined&&(e.maxLevel=$('input[name="maxLevel"]').attr("max"));t=t+"/level="+e.minLevel+"-"+e.maxLevel;history.pushState(null,null,t);filter(e,n)});$('select[name="rank"]').change(function(n){e.rank=$(this).val();t=t.replace(/\/rank=[\w\-]+/,"");if(e["rank"]!="all"){var r=JSON.parse(window.localStorage.roster);t=t+"/rank="+r.ranks[e.rank].toString().replace(" ","-").toLowerCase()}history.pushState(null,null,t);filter(e,n)});$('input[type="reset"]').click(function(n){e=[];t="/roster";history.pushState(null,null,t);filter(e,n)})});